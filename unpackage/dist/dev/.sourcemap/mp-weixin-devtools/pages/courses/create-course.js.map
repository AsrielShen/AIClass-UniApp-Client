{"version":3,"names":["courseName","common_vendor","ref","courseDes","fileName","filePath","userInfo","index","getStorageSync","formSubmit","__f__","uploadFile","url","utils_config","globalData","baseUrl","name","formData","value","description","token","success","res","backData","JSON","parse","data","code","showToast","title","icon","removeStorageSync","redirectTo","fail","err","formReset","selectFile","wx$1","chooseMessageFile","count","type","extension","file","tempFiles","isExcel","test","path","duration","wx","createPage","MiniProgramPage"],"sources":["create-course.vue","cGFnZXMvY291cnNlcy9jcmVhdGUtY291cnNlLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view id=\"create-course\" class=\"bg-color\">\r\n\t\t<view class=\"create-block\">\r\n\t\t\t<block-bar-other title=\"创建课程\" />\r\n\t\t\t<view class=\"action-block\">\r\n\t\t\t\t<form @submit=\"formSubmit\" @reset=\"formReset\">\r\n\t\t\t\t\t<view class=\"action-item\">\r\n\t\t\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t\t\t课程名\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<input v-model=\"courseName\" class=\"input-box\" type=\"text\" placeholder=\"请输入课程名\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"detail-block\">\r\n\t\t\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t\t\t课程描述\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<textarea v-model=\"courseDes\" class=\"large-textarea\" type=\"text\" auto-height disable-default-padding\r\n\t\t\t\t\t\t\tplaceholder=\"请输入描述信息\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"action-item\">\r\n\t\t\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t\t\t学生名单\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"file-name\">{{fileName}}</view>\r\n\t\t\t\t\t\t<button class=\"upload-button\" @click=\"selectFile\">选择文件</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"action-item tip-block\">\r\n\t\t\t\t\t\t提示：可选择提交格式为excel，首行元素分别为studentNumber,studentName\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<button form-type=\"submit\" class=\"button\">提交</button>\r\n\t\t\t\t\t<button form-type=\"reset\" class=\"button red\">重置</button>\r\n\t\t\t\t</form>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\"\r\nimport { globalData } from '@/utils/config.js'\r\n\r\nconst courseName = ref(\"\");\r\nconst courseDes = ref(\"\");\r\nconst fileName = ref(\"\");\r\nlet filePath = '';\r\nconst userInfo = uni.getStorageSync('userInfo');\r\n\r\nconst formSubmit = () => {\r\n\tconsole.log(\"here is submit\");\r\n\tuni.uploadFile({\r\n\t    url: globalData.baseUrl + \"/course/create\", // 你的后端接口\r\n\t    filePath: filePath,\r\n\t    name: 'file',   // 注意！这里name要和后端 `CourseCreateVO` 的 `file` 字段名一致\r\n\t    formData: {\r\n\t      courseName: courseName.value,\r\n\t      description: courseDes.value,\r\n\t      token: userInfo.token\r\n\t    },\r\n\t    success: (res) => {\r\n\t\t\tconst backData = JSON.parse(res.data);\r\n\t\t\tconsole.log(backData);\r\n\t\r\n\t\t\tif (backData.code === 0) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t  title: \"创建成功！\",\r\n\t\t\t\t  icon: \"success\"\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"认证错误，请重新登录\",\r\n\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t});\r\n\t\t\t\tuni.removeStorageSync(\"userInfo\");\r\n\t\t\t\tuni.redirectTo({\r\n\t\t\t\t    url: \"/pages/user/login\" \r\n\t\t\t\t});\r\n\t\t\t}\r\n\t    },\r\n\t    fail: (err) => {\r\n\t      console.error(err);\r\n\t      uni.showToast({\r\n\t        title: \"上传失败\",\r\n\t        icon: \"error\"\r\n\t      });\r\n\t    }\r\n\t  });\r\n}\r\nconst formReset = () => {\r\n\tfileName.value = \"\";\r\n\tfilePath = \"\";\r\n\tconsole.log(\"here is reset\");\r\n}\r\n\r\nconst selectFile = () => {\r\n\twx.chooseMessageFile({\r\n\t\tcount: 1,\r\n\t\ttype: 'file',\r\n\t\textension: ['.xls', '.xlsx'],\r\n\t\tsuccess: (res) => {\r\n\t\t\tconst file = res.tempFiles[0];\r\n\t\t\tconst isExcel = /\\.(xls|xlsx)$/i.test(file.name); // 判断文件类型是否为 Excel（.xls 或 .xlsx）\r\n\t\t\t\r\n\t\t\tif (isExcel) {\r\n\t\t\t\tfileName.value = file.name;\r\n\t\t\t\tfilePath = file.path;\r\n\t\t\t\tconsole.log(\"选择的文件是 Excel 文件:\", fileName);\r\n\t\t\t\tconsole.log(\"文件路径:\", filePath);\r\n\t\t\t} else {\r\n\t\t\t\twx.showToast({\r\n\t\t\t\t\ttitle: '请选择 Excel 文件',\r\n\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\tduration: 2000,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tfail: (err) => {\r\n\t\t\tconsole.error(\"选择文件失败：\", err);\r\n\t\t}\r\n\t});\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n#create-course {\r\n\t.create-block {\r\n\t\t.action-block {\r\n\t\t\tmargin: 20rpx 0;\r\n\t\t\tpadding: 0 30rpx;\r\n\t\t\tbackground-color: #fff;\r\n\r\n\t\t\t.action-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\tborder-bottom: 1rpx solid #ccc;\r\n\r\n\t\t\t\t.input-box {\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\tmargin-left: 20rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.file-name {\r\n\t\t\t\t\tmargin: 0 20rpx;\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\tcolor: gray;\r\n\t\t\t\t\twhite-space: nowrap;\r\n\t\t\t\t\t/* 禁止换行 */\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\t/* 超出部分隐藏 */\r\n\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t\t/* 超出部分显示省略号 */\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.upload-button {\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\tborder-radius: 15rpx;\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\tbackground-color: #39c5bb;\r\n\t\t\t\t\tborder: none\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.detail-block {\r\n\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\tborder-bottom: 1rpx solid #ccc;\r\n\r\n\t\t\t\t.large-textarea {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\tmin-height: 250rpx;\r\n\t\t\t\t\tmargin-top: 20rpx;\r\n\t\t\t\t\tpadding: 20rpx 15rpx;\r\n\t\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\t\tborder: 1px solid #ccc;\r\n\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.tip-block {\r\n\t\t\t\tborder: 0;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: gray;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t.button {\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tmargin: 20rpx 0;\r\n\t\t\t\tborder-radius: 50rpx;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tbackground-color: #39c5bb;\r\n\t\t\t\tborder: none\r\n\t\t\t}\r\n\r\n\t\t\t.red {\r\n\t\t\t\tcolor: red;\r\n\t\t\t\tborder: 1rpx solid red;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n</style>","import MiniProgramPage from 'C:/Users/19253/Desktop/AI-UniApp/ClientUniApp/pages/courses/create-course.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}